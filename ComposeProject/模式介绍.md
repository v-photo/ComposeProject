# 模式快速指南（新手向）

本项目提供五种运行模式，通过 CLI 参数 `--method` 选择：

- `auto`（默认）：自动根据数据分布在 Kriging 与 PINN 间选择；仅常规训练，无自适应加密。
- `kriging`：纯 Kriging 插值；适合数据较均匀、样本充足的场景。
- `pinn`：纯 PINN；若在 `config.py -> system.enable_pinn_adaptive=True`，会在首轮后再追加一轮随机配点的自适应加密训练。
- `compose`：轻量版“PINN + Kriging 残差引导”两阶段流程。首轮 PINN 训练，若 `system.enable_compose_adaptive=True`，再做一次残差侦察 + Kriging 代理 + 自适应配点 → 第二轮 PINN。无数据注入、无多周期循环、无基线对比。
- `adaptive_experiment`：完整自适应实验（推荐）。周期循环：PINN 训练（带早停/回退）→ 选配数据注入 → 残差侦察 + Kriging 代理 + 探索率递减的自适应配点 → 下一周期；结束后用“实际使用过的训练点”训练固定采样基线 PINN，输出对比图。

## 基本用法
```bash
# 默认（auto）
python main.py

# 指定模式
python main.py --method kriging
python main.py --method pinn
python main.py --method compose
python main.py --method adaptive_experiment

# 使用预设
python main.py --preset quick_test
python main.py --preset full_adaptive  # 建议与 --method adaptive_experiment 搭配
```

## 关键配置位置
- 通用：`config.py`
- 自适应实验专属：`config.py -> adaptive_experiment`
  - 训练循环：`total_epochs`、`adaptive_cycle_epochs`、`detect_every`、`num_residual_scout_points`
  - 探索率递减：`exploration.initial/final/decay`
  - 开关：`enable_kriging`、`enable_data_injection`、`enable_rapid_improvement_early_stop`
  - 数据拆分：`split_ratios`（主集+储备池）、`test_set_size`
  - 基线对比：`enable_baseline`
  - 输出文件后缀：`file_suffix`（图 `mre_comparison_<suffix>.png/pdf`）

## 何时选哪种模式
- 想省事：`auto`
- 数据均匀、插值任务：`kriging`
- 物理约束稀疏数据：`pinn`（必要时开 `enable_pinn_adaptive`）
- 只想加一轮残差加密且不需要多周期/注入/基线：`compose`
- 需要完整自适应循环、数据注入、Kriging 重采样、基线对比：`adaptive_experiment`

## 事件与输出
- 事件：`phase_transition`、`data_injection`、`kriging_resampling`、`early_stop`、`rollback` 会在曲线上标注。
- 输出：
  - 训练历史：`results/training_history_<exp>.npz`
  - 自适应对比图：`results/mre_comparison_<suffix>.png/pdf`（仅 adaptive_experiment）
  - 常规预测：`results/predictions_<exp>.npy`（非自适应模式）

