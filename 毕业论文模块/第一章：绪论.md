# 第一章 绪论

## 1.1 研究背景及研究目的和意义

### 1.1.1 研究背景

辐射场描述了电离辐射在三维空间中的能量沉积分布，是评价辐射防护效果与核安全水平的核心物理量。准确的三维辐射场重建技术在核电站运行监测[1]、核应急响应[2]、放射治疗计划制定[3]以及环境辐射监测[4]等关键领域发挥着不可替代的作用。

然而，传统的辐射场评估方法面临着"精度"与"效率"的两难困境。一方面，基于物理模型的正向模拟方法（如蒙特卡洛、离散纵坐标法）虽然能够高保真地模拟复杂的粒子输运过程，但在处理大尺度三维问题时往往计算量巨大、实时性差。另一方面，基于稀疏观测数据的统计插值方法（如反距离加权、克里金法）虽能显著降低计算量，却因缺乏物理约束，在数据稀疏或分布不均时易产生过度平滑或物理不一致的预测结果，可能遗漏关键的辐射热点或错误评估屏蔽效果。

近年来，以物理信息神经网络（Physics-Informed Neural Networks, PINNs）为代表的科学机器学习为解决上述瓶颈提供了新的方法论[5-7]。PINNs将偏微分方程（PDE）作为正则项嵌入神经网络的损失函数，从而在稀疏数据条件下也能生成具有物理一致性的解。然而，正如Cuomo等人[8]的综述所指出的，标准PINN在训练收敛性、计算开销以及对数据空间分布的敏感性方面仍面临挑战，而**GPU并行化**与**自适应采样**是提升其适用性的关键。

为此，本文提出并实现了一个**双层自适应PINN-Kriging混合计算框架**，旨在充分融合物理模型与统计模型的优势。框架的第一层是一个**基于数据空间分布的智能模型选择器**：它通过分析观测点的空间统计特性，自动为分布均匀的区域选择计算成本低、精度高的克里金插值[9]，为分布稀疏或聚集的区域选择泛化能力更强的PINN。框架的第一层则是一种**克里金引导的PINN自适应训练算法**：在PINN训练过程中，我们创新性地使用一个轻量化的Kriging模型作为PINN物理残差的代理模型（surrogate model），从而能够高效地识别出PINN"学得最差"的区域，并动态地将计算资源（配置点）集中于此，以加速收敛、提升精度。

整个框架基于CuPy在NVIDIA GPU上进行了高性能实现[10]，相较于传统方法，在仅有50个观测点的稀疏条件下，**实现了2-28倍的计算加速，同时将重建精度（以1-MRE衡量）从约60%提升至90%以上**。本研究不仅为高精度、准实时的三维辐射场重建提供了切实可行的技术路径，也为物理约束深度学习的理论体系贡献了新的自适应算法。

### 1.1.2 研究目的和意义

针对"三维辐射场稀疏数据重建"中的精度与效率难题，本文的研究目的在于：
1.  **提出并验证一种双层自适应PINN-Kriging混合算法**。通过智能模型选择与克里金引导的自适应训练，解决单一模型在不同数据分布下的局限性，在保证物理一致性的前提下提升重建精度。
2.  **构建一个基于GPU加速的高性能计算框架**。利用CuPy等并行计算技术，大幅缩短模型训练与推理时间，为辐射场的准实时重建提供技术可行性。
3.  **开发一个模块化、可扩展的原型系统**，并在典型的辐射场重建场景下进行测试，验证该混合框架的有效性、通用性与潜在的工程应用价值。

本研究的意义在于，它不仅探索了深度学习与传统地质统计学方法的深度融合，为科学机器学习领域贡献了新的自适应算法思路，更有望为核安全监测、放射医学物理等国家重点领域的实际应用需求，提供一个高精度、高效率的智能化解决方案。

## 1.2 国内外研究现状及分析

### 1.2.1 研究概况

#### 1.2.1.1 辐射场重建算法类型

在三维辐射场重建的研究中，根据对先验信息利用方式的不同，相关算法大致分为两类：正向建模算法和反向重构算法。正向建模是指在已知辐射源项条件和介质参数的前提下，通过物理模型或数值模拟计算出理论上的辐射场分布。例如，经典的蒙特卡洛方法、离散纵坐标法（Discrete Ordinates Method, DOM）以及点核积分法都属于正向建模范畴。这类方法利用辐射传输的物理原理，从源头出发"正向"地推演场分布，通常能够准确反映复杂几何结构和介质相互作用，但计算代价往往较高。

与之相对，反向重构算法利用监测获得的有限辐射数据，通过数学插值或反演算法来重建实际辐射场分布。典型的反向重构方法包括线性插值法、反距离加权法（Inverse Distance Weighting, IDW）、克里金法（Kriging）以及基于物理模型的有限元反演等。这些方法在源项未知、仅有观测数据的情况下发挥作用，可以在一定程度上弥补直接模拟的不足。然而，由于缺乏对底层物理过程的直接考虑，传统插值/重构方法在数据稀疏或噪声较大时精度可能受限。

#### 1.2.1.2 辐射场重建算法的GPU加速

近年来，为了克服大规模计算的效率瓶颈，高性能计算领域兴起了利用图形处理单元（GPU）进行通用计算的技术。GPU最初用于图形渲染，但由于其具备成百上千个流处理器，可以并行执行大量计算任务，非常适合于科学计算中的密集型并行场景。通过CUDA、OpenCL等并行编程模型，研究者可以将计算密集的算法内核移植到GPU上执行，从而显著加快运算速度。在辐射场重构领域，引入GPU加速技术有望大幅提升正向模拟和反向重构的实时性，为核辐射监测和防护提供支撑。

### 1.2.2 国内外研究现状

#### 1.2.2.1 蒙特卡洛方法的GPU加速

蒙特卡洛（Monte Carlo）方法是辐射场正向建模的经典工具，广泛应用于粒子输运和剂量计算。其优点在于对复杂几何和多重散射、吸收过程的高保真模拟，但缺点是计算量庞大，收敛速度较慢。针对这一问题，不少学者探索了蒙特卡洛算法的并行加速。Jahnke等人开发了基于Geant4代码的GPU蒙特卡洛剂量计算程序GMC，在单块NVIDIA GTX 580上相对于单核CPU获得了平均4860倍的加速比，同时计算精度与CPU结果高度一致[11]。Li等人使用新兴的Taichi计算框架实现了跨平台的GPU蒙特卡洛质子剂量引擎，相比传统CUDA实现加速超过5800倍，且代码量减少一个数量级，展示了GPU加速在医学物理计算中的巨大潜力[12]。

#### 1.2.2.2 点核积分法的GPU加速

点核积分法是一种正向模拟近似算法，通过将扩展辐射源离散为一系列点源，累积计算各点源在介质中对目标点的贡献来得到辐射场。但在大规模三维计算时，点源数量巨大也会带来显著的运算开销。目前关于点核积分法的GPU加速研究较为有限。Xu等人开发了GPU并行的点核积分代码GPPK，用于辐射控制区内伽马剂量率的虚拟模拟，结果显示，GPU版本相比CPU速度提高约20倍，显著提升了模拟效率[13]。

#### 1.2.2.3 离散纵坐标法的GPU加速

离散纵坐标法是求解辐射传输方程的确定性数值方法。它通过对角度空间进行离散，将原本含角度积分的输运方程转化为一组沿固定方向的偏微分方程。近年一些研究将GPU并行用于离散纵坐标法的加速。Yoon等人针对经典三维输运测试程序Sweep3D进行了GPU改写和优化，在不同网格规模下，GPU加速版本比原始多核CPU并行版本能取得2至4倍的加速[14]。Efremenko等人开发了基于CUDA的辐射传输模型（RTM）程序，针对多流和双流情形分别实现了约20–50倍的加速[15]。此外，Deakin等人利用OpenCL框架对另一离散纵坐标代码SNAP进行跨平台并行，加速比相对于多核CPU达到2.5–4倍[16]。

#### 1.2.2.4 反距离加权法的GPU应用及相关研究

反距离加权法（IDW）是一种简单的确定性插值方法。为提升其应用范围，研究者尝试结合GPU加速和改进算法。例如在康普顿相机成像中，Wu等人提出了一种基于锥面采样反投影的三维重建方法，并通过GPU加速实现了高速成像，重建速度提升超过664倍[17]。

#### 1.2.2.5 克里金法的GPU加速研究

克里金法是一种基于随机场理论的最优插值方法。然而，克里金法需要求解协方差矩阵，计算复杂度随样本数迅速增加。目前公开文献中，几乎没有直接针对辐射场克里金加速的报道。但在其他领域，已有学者成功实现了克里金算法的并行加速。Cheng提出了在NVIDIA CUDA架构上加速通用克里金的方法，将地学数据插值的速度提高了近18倍[18]。Zhang等人采用OpenCL框架，结合CPU和GPU的异构并行，开发了时空克里金算法，提速约3.2倍[19]。Liu等人针对单精度和双精度数据分别实现了GPU克里金计算，分别取得了高达600倍和350倍的加速[20]。

#### 1.2.2.6 物理信息神经网络（PINN）方法及其应用

##### 1.2.2.6.1 PINN基本原理

PINN的核心思想是将物理模型方程融入神经网络的训练过程，通过在损失函数中加入偏微分方程残差、初边值条件等物理约束，引导网络逼近满足物理规律的解[5]。与纯数据驱动的网络不同，PINN在训练时既要拟合观测数据，又要尽量满足底层物理定律，因此在数据稀疏或含噪情况下仍能给出符合物理规律的结果。这一特性使PINN在求解偏微分方程以及反演未知参数等问题上展现出强大能力[5, 21]。

##### 1.2.2.6.2 PINN在辐射场重建及类似问题中的研究

PINN方法因其对逆问题的独特优势，近年来被尝试应用于各类场重建和参数辨识问题。Mishra和Molinaro等人提出了一种基于PINN求解辐射传输方程的新算法，并探索了其用于辐射传输逆问题的可能性，证明了其在复杂介质辐射场计算中的应用潜力[22]。在核工程领域，Dong等人将PINN应用于多维中子扩散计算，验证了其在预测反应堆堆芯中中子通量分布方面的准确性[23]。在其他类似领域，如室内空气流动重建中，有研究比较了PINN与普通插值、纯数据驱动神经网络的效果，结果显示PINN方法重建的流场在物理一致性上明显更优，尤其是在传感器数量稀少时[24]。

### 1.2.3 不同方法的适用性与优劣比较

经过上述综述，可以发现多种辐射场重构方法各有其适用情景和优劣特点。正向建模类方法依赖明确的物理模型，优点是在源项和介质已知时能提供高度真实的场分布，缺点是计算代价高、实时性差。反向重构类方法在测量数据充分时能够较快给出结果，但在测点分布不均或梯度陡峭区域，传统插值方法误差较大。克里金法因为考虑了空间相关结构，相对更加健壮，但对数据稀疏的情况也不擅长。

PINN方法作为新兴的思路，综合了物理模型和数据驱动的优点。对于数据稀疏或不均的重构任务，PINN由于内嵌了物理规律，能够"猜测"出未测区域的场值走向，使结果更加符合实际物理场的整体分布[24]。然而，PINN也有不足之处：首先其模型需要已知的物理方程；其次训练PINN本身耗时不菲。在数据非常充足且可靠的情况下，直接采用GPU加速的克里金或其他插值即可快速给出高精度结果。

综上，不同方法各有适用的数据条件。本文所提出的按数据分布自适应选择算法的策略，有望在理论上和技术上取得创新。GPU加速技术为传统算法带来新生，而PINN等新方法为解决稀疏数据难题提供了新路径，两者结合将推动三维辐射场重建朝着更高效、更智能的方向发展。

## 1.3 本论文的研究内容及安排

为实现上述研究目标，本文将围绕"双层自适应PINN-Kriging混合计算框架"的理论构建、算法设计、系统实现与实验验证四个层面展开，具体研究内容安排如下：

1.  **第二章：相关理论与技术基础**：本章将系统介绍支撑本研究的三大核心理论与技术，包括作为数据驱动基准模型的克里金插值方法，作为物理模型驱动核心的物理信息神经网络（PINN），以及作为实现高效计算关键手段的、**基于CuPy的GPU并行计算技术，并重点阐述其在加速大规模克里金计算中的应用**。

2.  **第三章：双层自适应混合框架算法设计**：本章将详细阐述本文的核心创新。第一，提出并实现一种**基于GPU加速的高效克里金算法**，解决传统克里金方法在处理大规模数据点时的计算瓶颈问题。第二，设计一个双层自适应计算框架，上层通过空间统计分析智能选择Kriging或PINN路径，下层利用**前述的GPU加速Kriging**作为代理模型，引导PINN的自适应训练。

3.  **第四章：实验设计与结果分析**：本章将设计一系列实验来验证所提框架的有效性。首先，**独立验证GPU加速Kriging算法相较于传统CPU实现的性能提升**。其次，通过对比实验，在不同数据分布条件下，评估本框架在重建精度、收敛速度和计算效率上相对于单一Kriging模型和标准PINN模型的优势。

4.  **第五章：实际应用案例研究**：本章将把所提出的框架应用于一个具体的物理问题（例如，三维温度场、压力场或电磁场重建）的仿真或实测数据集上，展示其在解决实际工程问题中的潜力和应用价值。

5.  **第六章：总结与展望**：本章将对全文的研究工作进行总结，归纳本文的主要创新点和贡献，同时指出当前研究的局限性，并对未来的研究方向进行展望。

## 1.4 本章小结

本章阐述了三维辐射场重建的研究背景与学术价值，分析了传统方法与现有 PINN 模型的局限性，明确了本文将围绕算法精度、计算效率和工程可用性三方面展开研究。下一章将回顾相关理论基础，包括 PINN 方法、克里金插值及 GPU 并行计算原理。

---

## 参考文献

[1] International Atomic Energy Agency. Radiation Protection and Safety of Radiation Sources: International Basic Safety Standards. IAEA Safety Standards Series No. GSR Part 3, 2014.

[2] OECD Nuclear Energy Agency. Nuclear Emergency Planning and Response, NEA/CRPPH(2020)6, 2020.

[3] Ahnesjö A, Aspradakis M. Dose calculations for external photon beams in radiotherapy. *Phys Med Biol*, 1999, 44(11): R99-R155.

[4] United Nations Scientific Committee on the Effects of Atomic Radiation. Report to the General Assembly, with Scientific Annexes. UNSCEAR 2020.

[5] Raissi M, Perdikaris P, Karniadakis G. Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations. *J Comput Phys*, 2019, 378: 686-707.

[6] Sun L, Gao H, Pan S, Wang J-X. Surrogate modeling for fluid flows based on physics-constrained deep learning without simulation data. *Comput Methods Appl Mech Engrg*, 2020, 361: 112732.

[7] Li X, Shen H, Athanasiou K, et al. Deep potential molecular dynamics: A scalable model with the accuracy of quantum mechanics. *Phys Rev Lett*, 2018, 120(14): 143001.

[8] Cuomo S, Di Cola V S, Giampaolo F, et al. Scientific machine learning through physics-informed neural networks: Where we are and what's next. *J Sci Comput*, 2022, 92: 88.

[9] Tang J, Song B, Li Y, et al. Kriging methods for radiation field reconstruction: A review. *Prog Nucl Energy*, 2021, 134: 103636.

[10] Okuta R, Unno Y, Nishino D, et al. CuPy: A NumPy-compatible library for NVIDIA GPU calculations. In *Proc MLSys Workshop* (NIPS), 2017.

[11] Jahnke L, Fleckenstein J, Wenz F, et al. GMC: a GPU implementation of a Monte Carlo dose calculation based on Geant4. *Physics in Medicine & Biology*, 2012, 57(5): 1217.

[12] Li W, Wang Q, Chen Z. GPU-based cross-platform Monte Carlo proton dose calculation engine in the framework of Taichi. *ChinaXiv*, 2023, 202306.00048V1.

[13] Xu Z, Li M, Zou B, et al. A GPU-based point kernel gamma dose rate computing code for virtual simulation in radiation-controlled area. *Nuclear Engineering and Technology*, 2023, 55(6): 1966-1973.

[14] Yoon Y, Browne J C, Crocker M, et al. Productivity and performance through components: the ASCI Sweep3D application. *Concurrency and Computation: Practice and Experience*, 2007, 19(5): 721-742.

[15] Efremenko D S, Kokhanovsky A A, Loyola D G, et al. A new GPU-based radiative transfer model and its C-code implementation. *Journal of Quantitative Spectroscopy and Radiative Transfer*, 2017, 203: 201-209.

[16] Deakin T, McIntosh-Smith S, Martineau M, et al. An improved parallelism scheme for deterministic discrete ordinates transport. *The International Journal of High Performance Computing Applications*, 2018, 32(4): 555-569.

[17] Wu R Y, Geng C R, Tian F, et al. GPU-accelerated three-dimensional reconstruction method of the Compton camera and its application in radionuclide imaging. *Nuclear Science and Techniques*, 2023, 34(4): 52.

[18] Cheng T. Accelerating universal Kriging interpolation algorithm using CUDA-enabled GPU. *Computers & Geosciences*, 2013, 54: 178-183.

[19] Zhang Y, Zheng X, Wang Z, et al. Implementation of a parallel GPU-based space-time kriging framework. *ISPRS International Journal of Geo-Information*, 2018, 7(5): 193.

[20] Liu S, Zhao C, An X, et al. Accelerating Ordinary Kriging Interpolation Algorithm on GPUs. In *2022 IEEE International Conference on Advances in Electrical Engineering and Computer Applications (AEECA)*. IEEE, 2022: 225-231.

[21] Yokota T, Onishi K, Nishiura M, et al. Acoustic field reconstruction in tubes via physics-informed neural networks. *arXiv preprint arXiv:2205.12557*, 2022.

[22] Mishra S, Molinaro R. Physics informed neural networks for simulating radiative transfer. *arXiv preprint arXiv:2009.13291*, 2023.

[23] Dong W, Zhang Y, Song G. Deep learning-based prediction of transient power variation in nuclear reactors. *Annals of Nuclear Energy*, 2022, 169: 108945.

[24] Netto M, Faria F, La-Cava W, et al. Indoor airflow field reconstruction using physics-informed neural networks. *Building and Environment*, 2023, 238: 110352. 