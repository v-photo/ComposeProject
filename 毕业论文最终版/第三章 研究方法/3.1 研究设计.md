# 3.1 总体研究设计与框架

### 3.1.1 框架设计原则

为响应第二章所提出的理论假设，并致力于解决现有物理场重建方法在处理稀疏、非均匀数据时所面临的精度、效率与鲁棒性挑战，本研究的设计核心是一种**“分而治之、协同增效”**的原则。我们不寻求一种“万能”的单一模型，而是构建一个能够根据问题特性进行**自适应决策**，并让不同模型在各自擅长的领域**协同工作**的智能化计算框架。

该框架被命名为**“双层自适应PINN-Kriging混合计算框架” (Two-Layer Adaptive PINN-Kriging Hybrid Computing Framework)**。其关键特性体现在三个方面：
*   **混合性 (Hybrid)**：深度融合了基于地质统计学的克里金（Kriging）方法与基于科学机器学习的物理信息神经网络（PINN）。
*   **自适应性 (Adaptive)**：框架包含两个层次的自适应机制。第一层是宏观的**模型路径选择**，第二层是微观的**训练过程优化**。
*   **高性能 (High-Performance)**：框架中的关键计算瓶颈，特别是克里金插值，都经过了GPU并行化，以确保整体流程的高效率。

### 3.1.2 框架总体流程

本框架的总体工作流程旨在模拟一位领域专家的决策过程。它首先对数据进行快速评估，然后根据评估结果，选择最优的策略进行精细化的求解。整个流程可以通过下图清晰地展示：

```mermaid
graph TD
    A[输入: 稀疏三维观测数据集<br>{x, y, z, value}] --> B{Step 1: 空间统计特性分析};
    B --> C{Step 2: 智能模型选择<br>判断数据分布均匀性};
    C -- "均匀/稠密" --> D[路径 A: 高效重建模式];
    C -- "稀疏/非均匀" --> E[路径 B: 高精度重建模式];
    
    subgraph 路径 A
        D --> D1[调用GPU加速的Kriging模块];
        D1 --> D2[直接进行全场插值重建];
    end
    
    subgraph 路径 B
        E --> E1[激活PINN训练流程];
        E1 --> E2{Step 3: Kriging引导的自适应训练循环};
        E2 --> E3[a. 训练PINN N个轮次];
        E3 --> E4[b. 调用GPU-Kriging计算全局方差场 (作为误差代理)];
        E4 --> E5[c. 在高方差区域生成新的配置点];
        E5 --> E6[d. 将新配置点注入PINN模型];
        E6 --> E7{e. 检查收敛条件};
        E7 -- "未收敛" --> E3;
        E7 -- "已收敛" --> E8[输出PINN重建结果];
    end
    
    D2 --> F[输出: 重建后的三维物理场];
    E8 --> F;

```
*<center>图3-1 双层自适应PINN-Kriging混合计算框架总体流程图</center>*

### 3.1.3 核心组件概述

根据上述流程图，本框架主要由以下三个紧密耦合的核心组件构成：

1.  **高性能Kriging计算模块 (详见 3.2节)**：这是整个框架的“工作母机”。它基于CuPy库在GPU上实现了高性能的克里金插值算法。在**路径A**中，它作为**主要的重建工具**；在**路径B**中，它则扮演着一个计算廉价的**物理误差代理模型**的角色，为PINN的自适应训练提供关键的方差信息。

2.  **第一层：智能模型选择器 (详见 3.3节)**：这是框架的“决策大脑”。它负责执行流程图中的Step 1和Step 2。该模块通过计算输入观测数据点的空间分布变异系数（Coefficient of Variation, CV）等统计指标，对数据的均匀性进行量化评估，并依据预设的阈值，自动选择执行效率优先的**路径A**还是精度优先的**路径B**。

3.  **第二层：Kriging引导的PINN自适应训练模块 (详见 3.4节)**：这是框架的“创新核心”，对应流程图中的Step 3。当路径B被激活时，该模块将启动一个创新的训练循环。它不再依赖于计算昂贵的全局PDE残差来指导采样，而是周期性地调用高性能Kriging模块来快速获得全局的预测方差场，并将其作为PINN求解“硬区域”的代理指标，动态地将新的计算资源（配置点）投放到这些区域，从而在保证物理一致性的前提下，显著加速PINN的收敛并提升最终精度。

### 3.1.4 本章结构安排

为详细阐述上述设计，本章后续内容将作如下安排：3.2节将首先介绍作为框架基础的高性能Kriging模块的并行化实现细节。3.3节将详细阐述第一层智能模型选择器的具体原理和实现。3.4节将深入剖析第二层Kriging引导的PINN自适应训练这一核心创新算法的完整流程与细节。
