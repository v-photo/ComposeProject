# 3.2 智能模型选择器

智能模型选择器（Intelligent Model Selector）是本框架“双层自适应路径”中的第一层决策单元。它的核心任务是解决辐射场重建中的一个根本性问题：**针对当前观测数据的分布形态，哪种数学模型能在最短时间内提供最可信的结果？**

### 3.2.1 分布特征判据：最近邻变异系数

在实际工程场景中，观测数据的分布形态千差万别。为了定量描述空间点集的“均匀程度”或“聚集程度”，本研究引入了**最近邻距离变异系数 (Coefficient of Variation of Nearest Neighbor Distance, $CV_{NN}$)** 作为核心判别指标。

该指标的物理意义可以通过以下直观逻辑解释：
假设在一个三维空间中分布着若干探测点，我们计算每一个点到其最近邻点的欧氏距离。
*   **均匀分布**：如果探测器是按照规则网格布设的，或者分布非常均匀，那么每个点到最近邻居的距离几乎是相等的。这意味着这些距离数值的波动（标准差）很小，因此 $CV_{NN}$ 会趋近于 0。
*   **聚集分布**：如果探测器受限于地形只能沿着某条道路布置，或者集中在辐射源附近，导致一部分点挤在一起（距离极小），而另一部分区域又是大面积空白。这意味着最近邻距离的差异巨大，波动剧烈，因此 $CV_{NN}$ 会显著增大。

数学表达上，对于包含 $N$ 个观测点的集合，计算过程包含以下步骤：

1.  **坐标归一化**：为了消除不同空间维度（如水平范围 $X, Y$ 与垂直高度 $Z$）尺度差异带来的影响，首先将所有观测点的空间坐标映射到 $[0, 1]^3$ 的单位立方体中。
2.  **最近邻距离计算**：计算归一化后每个点到其最近邻点的欧氏距离 $d_i$。
3.  **变异系数统计**：计算距离集合的均值 $\mu_d$ 和标准差 $\sigma_d$，得到 $CV_{NN} = \sigma_d / \mu_d$。

### 3.2.2 自动决策逻辑

基于大量实验数据的统计分析，本系统确立了一套经验阈值判据（通常设定为 0.6），用于指导算法路径的自动切换：

1.  **数据驱动路径 (GPU-Kriging)**
    *   **触发条件**：$CV_{NN} < T_{threshold}$（数据足够均匀）。
    *   **决策依据**：当数据分布均匀时，空间自相关性（Spatial Autocorrelation）能够得到很好的保持。此时，克里金插值算法能够充分利用周围点的信息进行精确估计。更重要的是，相比于深度学习，Kriging 的计算开销极低（秒级甚至毫秒级），在满足精度前提下是效率最优的选择。

2.  **物理约束路径 (PINN)**
    *   **触发条件**：$CV_{NN} \ge T_{threshold}$（数据聚集或稀疏）。
    *   **决策依据**：当数据出现明显的聚集或大面积缺测时，纯数学插值往往会因为缺乏支撑点而产生剧烈的数值震荡（Runge 现象）或错误地趋向于全局均值。此时，必须引入物理信息神经网络。PINN 不完全依赖数据点，而是通过求解辐射传输的偏微分方程（PDE）来约束解空间。在无数据区域，它依靠物理规律进行“逻辑外推”，从而保证重建结果在物理上的合理性与一致性。

### 3.2.3 异常处理与人工干预机制

尽管自动选择器在大多数情况下能做出正确判断，但为了应对极端工况，系统设计了多重鲁棒性保障机制：

*   **极小样本保护**：当观测点数量极少（例如 $N < 100$）时，无论分布如何，克里金算法的变异函数拟合都将变得极不稳定。此时系统会触发保护逻辑，强制锁定至 PINN 路径，利用物理方程的先验知识来弥补数据的极度匮乏。
*   **边缘情况处理**：当 $CV_{NN}$ 处于阈值附近的模糊地带时，系统默认倾向于选择鲁棒性更强的 PINN 路径，以牺牲一定的计算时间为代价，换取更高的可靠性。
*   **人工超控接口**：在某些特殊科研场景下（如专门研究某类算法的极限性能），研究人员可以通过系统配置参数强制指定运行路径，越过自动选择器的判断。这种设计确保了框架既具有自动化的便利性，也保留了作为科研工具的灵活性。
